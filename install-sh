#!/bin/sh

# Phoronix Test Suite
# URLs: http://www.phoronix.com, http://www.phoronix-test-suite.com/
# Copyright (C) 2008, Phoronix Media
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program. If not, see <http://www.gnu.org/licenses/>.

# Generic Phoronix Test Suite installer

if [ "X$1" = "X" ]
then
	INSTALL_PREFIX="/usr"
else
	INSTALL_PREFIX="$1"
fi

if [ ! -w $INSTALL_PREFIX ]
then
	echo "\nERROR: $INSTALL_PREFIX is not writable. Run this installer as root or specify a different directory as the first argument sent to this script.\n"
	exit
fi

mkdir -p $INSTALL_PREFIX/bin/
mkdir -p $INSTALL_PREFIX/share/man/man1/
mkdir -p $INSTALL_PREFIX/share/phoronix-test-suite/
mkdir -p $INSTALL_PREFIX/share/doc/phoronix-test-suite/

cp CHANGE-LOG $INSTALL_PREFIX/share/doc/phoronix-test-suite/
cp COPYING $INSTALL_PREFIX/share/doc/phoronix-test-suite/
cp AUTHORS $INSTALL_PREFIX/share/doc/phoronix-test-suite/

cd documentation/
cp -r * $INSTALL_PREFIX/share/doc/phoronix-test-suite/
cd ..
rm -rf $INSTALL_PREFIX/share/doc/phoronix-test-suite/man-pages/

cp documentation/man-pages/*.1 $INSTALL_PREFIX/share/man/man1/  

cp -r pts/ $INSTALL_PREFIX/share/phoronix-test-suite/
rm -f $INSTALL_PREFIX/share/phoronix-test-suite/pts/etc/scripts/package-build-*
cp -r pts-core/ $INSTALL_PREFIX/share/phoronix-test-suite/

sed 's:PTS_DIR=`pwd`:PTS_DIR='"$INSTALL_PREFIX"'\/share\/phoronix-test-suite:g' phoronix-test-suite > $INSTALL_PREFIX/bin/phoronix-test-suite
chmod +x $INSTALL_PREFIX/bin/phoronix-test-suite

echo "\nPhoronix Test Suite Installation Completed\n
Executable File: $INSTALL_PREFIX/bin/phoronix-test-suite
Documentation: $INSTALL_PREFIX/share/doc/phoronix-test-suite/
Phoronix Test Suite Files: $INSTALL_PREFIX/share/phoronix-test-suite/\n"
