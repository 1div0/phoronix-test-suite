#!/bin/sh

# Phoronix Test Suite
# Copyright (C) 2008, Phoronix Media.
# http://www.phoronix.com/
# http://www.phoronix-test-suite.com/
# The Phoronix Test Suite is licensed under the GNU GPLv3. For more information see COPYING

# Full path to root directory of the actual Phoronix Test Suite code
export PTS_DIR=`pwd`

if [ -x /usr/bin/php5 ] || [ -x /usr/local/bin/php5 ]
then
	export PHP_BIN="php5"
elif [ -x /usr/bin/php ] || [ -x /usr/local/bin/php ]
then
	export PHP_BIN="php"
else
	export PHP_BIN=""
fi

if [ "X$PHP_BIN" = "X" ]
then
	echo "\n\nPHP5 CLI Must Be Installed To Run The Phoronix Test Suite!"
	echo "Only PHP For The Command Line Is Needed, Not A Full-Blown PHP w/ Web Server"
	echo "The PHP CLI package is usually called php-cli or php5-cli. Also required is the PHP GD library (php-gd)"
	echo "To attempt to have the dependencies installed automatically, run: phoronix-test-suite install-dependencies pts"
	echo "For support visit: http://www.phoronix.com/forums/forumdisplay.php?f=49\n\n"
fi

if [ $PTS_DIR != `pwd` ]
then
	cd $PTS_DIR
fi

case "$1" in
"install")
	$PHP_BIN pts-core/pts-run-cmd.php INSTALL_BENCHMARK $2
	;;
"force-install")
	$PHP_BIN pts-core/pts-run-cmd.php FORCE_INSTALL_BENCHMARK $2
	;;
"install-dependencies")
	$PHP_BIN pts-core/pts-run-cmd.php INSTALL_EXTERNAL_DEPENDENCIES $2
	;;
"run")
	$PHP_BIN pts-core/pts-run-benchmark.php $2
	;;
"batch-run")
	$PHP_BIN pts-core/pts-run-benchmark.php $2 BATCH
	;;
"benchmark")
	$PHP_BIN pts-core/pts-run-cmd.php INSTALL_BENCHMARK $2
	$PHP_BIN pts-core/pts-run-benchmark.php $2
	;;
"batch-benchmark")
	$PHP_BIN pts-core/pts-run-cmd.php INSTALL_BENCHMARK $2
	$PHP_BIN pts-core/pts-run-benchmark.php $2 BATCH
	;;
"merge-results")
	$PHP_BIN pts-core/pts-merge-results.php $2 $3 $4
	;;
"remove-result")
	$PHP_BIN pts-core/pts-run-cmd.php REMOVE_RESULT $2
	;;
"remove-all-results")
	$PHP_BIN pts-core/pts-run-cmd.php REMOVE_ALL_RESULTS
	;;
"upload")
	$PHP_BIN pts-core/pts-run-cmd.php UPLOAD_RESULT $2
	;;
"list-tests")
	$PHP_BIN pts-core/pts-run-cmd.php LIST_TESTS
	;;
"list-suites")
	$PHP_BIN pts-core/pts-run-cmd.php LIST_SUITES
	;;
"list-results" | "list-saved-results")
	$PHP_BIN pts-core/pts-run-cmd.php LIST_SAVED_RESULTS
	;;
"show-result")
	$PHP_BIN pts-core/pts-run-cmd.php SHOW_RESULT $2
	;;
"suite-info" | "suite-information")
	$PHP_BIN pts-core/pts-run-cmd.php SUITE_INFO $2
	;;
"test-info" | "test-information")
	$PHP_BIN pts-core/pts-run-cmd.php TEST_INFO $2
	;;
"system-info" | "system-information")
	$PHP_BIN pts-core/pts-run-cmd.php SYS_INFO
	;;
"diagnostics")
	$PHP_BIN pts-core/pts-run-cmd.php DIAGNOSTICS_DUMP
	;;
"remote-comparison")
	$PHP_BIN pts-core/pts-run-cmd.php REMOTE_COMPARISON $2 $3
	;;
"initial-config")
	$PHP_BIN pts-core/pts-run-cmd.php INITIAL_CONFIG
	;;
"login")
	$PHP_BIN pts-core/pts-run-cmd.php LOGIN
	;;
*)
	echo "\n================================="
	echo "Phoronix Test Suite"
	echo "http://www.phoronix-test-suite.com/"
	echo "=================================\n"
#	echo "gui: Launch The Phoronix Test Suite GUI"
	echo "install <suite OR test>: Install or Update The Specified Test(s)"
	echo "install-dependencies <suite OR test>: Install The External (Distribution) Dependencies For Specified Test(s)"
	echo "run <suite OR test>: Run The Specified Test/Suite"
	echo "batch-run <suite OR test>: Run The Specified Test/Suite in Batch Mode"
	echo "benchmark <suite OR test OR saved file>: Same as manually running install and then run"
	echo "batch-benchmark <suite OR test OR saved file>: Same as manually running install and then run in Batch Mode"
	echo "merge-results <Saved File 1 OR Global ID> <Saved File 2 OR Global ID> <Save To>: Merge two saved result sets"
	echo "list-tests: List all Phoronix Test Suite test profiles"
	echo "list-suites: List all Phoronix Test Suites"
	echo "list-results: List all saved results"
	echo "remove-result <Saved File>: Remove this saved result file and associated files"
	echo "remove-all-results: Removes all saved results and associated files"
	echo "suite-info: Show tests in a suite and other information about the suite"
	echo "test-info: Show information about a test"
	echo "system-info: Dump detected software and hardware information detected by PTS"
	echo "upload <Saved File>: Upload these results to be shared globally"
	echo "show-result <Saved File>: Show this result file in your web browser"
	echo "login: Enter in your PTS Global log-in information for uploading results"
	echo "\n"
	;;
esac
